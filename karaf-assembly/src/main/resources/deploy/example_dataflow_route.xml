<?xml version="1.0" encoding="UTF-8"?>
<blueprint
    xmlns="http://www.osgi.org/xmlns/blueprint/v1.0.0"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="
      http://www.osgi.org/xmlns/blueprint/v1.0.0 http://www.osgi.org/xmlns/blueprint/v1.0.0/blueprint.xsd
       http://camel.apache.org/schema/blueprint http://camel.apache.org/schema/blueprint/camel-blueprint.xsd">

<!-- The following block is necessary to make the camel-hdfs2 component load in Karaf. You will get "no filesystem for scheme hdfs" otherwise. -->
<bean id="hdfsOsgiHelper" class="org.apache.camel.component.hdfs2.HdfsOsgiHelper">
   <argument>
      <map>
         <entry key="file:///" value="org.apache.hadoop.fs.LocalFileSystem"  />
         <entry key="hdfs://192.168.56.101:8020/" value="org.apache.hadoop.hdfs.DistributedFileSystem" />
      </map>
   </argument>
</bean>
<bean id="hdfs2" class="org.apache.camel.component.hdfs2.HdfsComponent" depends-on="hdfsOsgiHelper" />

<!-- Class name refers to our Interceptor -->
  <bean id="dataFlowControl" class="de.fhg.aisec.dfpolicy.PEP"/>
    <bean id="sjms" class="org.apache.camel.component.sjms.SjmsComponent">
        <property name="connectionFactory">
            <bean class="org.apache.activemq.ActiveMQConnectionFactory">
                <argument value="tcp://127.0.0.1:61616"/>
                            <property name="userName" value="karaf"/>
                            <property name="password" value="karaf"/>
            </bean>
        </property>
	</bean>


  <camelContext id="camel" xmlns="http://camel.apache.org/schema/blueprint">
      <route id="activemq-activemq-route">
              	<from uri="sjms:queue:input"/>
        	<to uri="sjms:queue:process" />
      </route>
  </camelContext>

</blueprint>

