<?xml version="1.0" encoding="UTF-8"?>
<blueprint xmlns="http://www.osgi.org/xmlns/blueprint/v1.0.0"
           xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"    
           xmlns:camel="http://camel.apache.org/schema/blueprint"
           xsi:schemaLocation="
               http://www.osgi.org/xmlns/blueprint/v1.0.0 http://www.osgi.org/xmlns/blueprint/v1.0.0/blueprint.xsd
               http://camel.apache.org/schema/blueprint http://camel.apache.org/schema/blueprint/camel-blueprint.xsd">
    <bean id="milo-client" class="org.apache.camel.component.milo.client.MiloClientComponent">
        <!--<property name="enableAnonymousAuthentication" value="true"/>-->
    </bean>

    <camelContext xmlns="http://camel.apache.org/schema/blueprint">
      <route id="opctorest">
        <from uri="milo-client:tcp://10.244.192.172:4840?node=RAW(ns=2;i=3)&amp;samplingInterval=10000"/>        
        <log message="Triggered Route: opctorest, requesting node: Sensorreading body: ${body}"/>
        <setHeader headerName="CamelHttpMethod">
          <constant>POST</constant>
        </setHeader>
        <convertBodyTo type="java.lang.String"/>
        <to uri="http://localhost:8080/sensordataapp/sensordataelements/addraw"/>
        <log message="Got ${body}"/>        
      </route>
      <route id="opctorestwrite">
        <from uri="timer://simpleTimer?period=10000"/>  
        <setBody>
          <simple>0</simple>
        </setBody>
        <convertBodyTo type="java.lang.Integer"/>
        <log message="Triggered Route: opctorestwrite, writingSensorreading body: ${body}"/>
        <to uri="milo-client:tcp://10.244.192.172:4840?node=RAW(ns=2;i=2)"/>        
      </route>
     <route id="opctorest-LED">
        <from uri="milo-client:tcp://sensordemo-pi-5.aisec.fraunhofer.de:4840?node=RAW(ns=1;i=1002)&amp;samplingInterval=10000"/>        
        <log message="Triggered Route: opctorest, requesting node: Sensorreading body: ${body}"/>
        <setHeader headerName="CamelHttpMethod">
          <constant>POST</constant>
        </setHeader>
        <convertBodyTo type="java.lang.String"/>
        <!--<to uri="http://localhost:8080/sensordataapp/sensordataelements/addraw"/>-->
        <log message="Got ${body}"/>  
        <to uri="mock:fooOrders"/>      
      </route>
      <route id="opctorestwrite-LED">
        <from uri="timer://simpleTimer?period=10000"/>  
        <setBody>
          <simple>6</simple>
        </setBody>
        <convertBodyTo type="java.lang.String"/>
        <log message="Triggered Route: opctorestwrite, writingSensorreading body: ${body}"/>
        <to uri="milo-client:tcp://sensordemo-pi-5.aisec.fraunhofer.de:4840?node=RAW(ns=1;i=1002)"/>        
      </route>
    </camelContext>
</blueprint>
